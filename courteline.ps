%!PS

/cm { 28.346 mul } bind def % conversion point -> cm

% distances
/marge    1.5 cm def
/largeur 21.0 cm def
/hauteur 29.7 cm def

/taille-titre   25 def
/taille-echelle 13 def

/cloison        {  5 setlinewidth } bind def % largeur des cloisons
/cloison-double { 10 setlinewidth } bind def % largeur des cloisons doubles
/porteur        { 18 setlinewidth } bind def % largeur des murs porteurs

% utilitaires

% passage en ISOLatin-1 (pour accents corrects)
% pris dans Red Book [en p.275, fr p.284]
/convert2latin1 { % <font-name> convert2latin1 -
  % calcule le nouveau nom
  dup dup dup dup
  length string cvs
  exch length 10 add dup string dup 3 -1 roll 10 sub (-ISOLatin1) putinterval
  dup 3 1 roll exch 0 exch  putinterval cvn
  % change l'encodage
  exch dup findfont
  dup length dict
  begin
    { 1 index /FID ne {def} {pop pop} ifelse } forall
    /Encoding ISOLatin1Encoding def
    currentdict
  end
  definefont pop
  def
} bind def

/Helvetica      convert2latin1
/Helvetica-Bold convert2latin1

/grille { % grille -
  gsave
    1 setlinewidth
    0.80 setgray
    2 {
      100 { 0 0 moveto 0 1000 rlineto 10 0 translate } repeat
      90 rotate
    } repeat
    stroke
  grestore
} def

/titre   { % <string> titre -
  gsave
    marge hauteur marge sub taille-titre sub moveto
    /Helvetica-Bold taille-titre selectfont show
  grestore
} bind def

% pièces

/salle-de-bain {
  gsave
    show-grille {
       -5    0 moveto
        0  203 rlineto
      310    0 rlineto
        0 -203 rlineto
      clip newpath
      0 0 moveto grille
      cliprestore
    } if

    -2.5 0 moveto
    cloison 0 185 rlineto
    currentpoint stroke moveto
    -2.5 9 rmoveto
    porteur 310 0 rlineto stroke

    0 150 2.5 add moveto
    cloison 85 0 rlineto
    currentpoint stroke moveto
    2.5 -2.5 rmoveto
    0 35 rlineto stroke

    305 185 moveto
    -2.5 0 rmoveto
    0 -185 rlineto
    stroke

    1 setlinewidth
    -5 0 moveto
    310 0 rlineto stroke

  grestore
} def

% document

/show-grille true def

(Salle de bain) titre
1 cm 100 7 div div % echelle

gsave
  marge dup translate
  90 rotate
  dup scale
  5 -203 translate
  salle-de-bain
grestore

showpage
